function d = exploit (w_out, w, w_back, x_300, d_300, n)
% simulate the sin wave after the 300th time step
% x_300, d_300: the values of the state and the teacher signal at the 300th
% step x_300 20 by 1 d300 1 by 1
% n the number of steps to generate

xs = zeros(size(x_300, 1), n+1);
xs(:,1) = x_300;
d = zeros(n+1, 1);
d(1) = d_300;

for i=2:(n+1)
    % update state
    internal = w' * xs(:,i-1);
    back_proj =  w_back * d(i-1);
    xs(:, i) = tanh(internal + back_proj);
    
    % get oupout 
    d(i) = w_out' * xs(:,i);
end

d = d(2:(n+1));
